{% extends "layout.html" %}

{% block title %}Companies{% endblock %}

{% block content %}
<section class="button-container">
  <h1 data-aos="fade-down">Find your company schedule</h1>
  
  {% if error %}
    <p style="color:red;" data-aos="fade-up">{{ error }}</p>
  {% endif %}

  <form method="POST" action="/companies" class="button-container" data-aos="fade-up">
    <!-- hint if the student is stupid -->
    {% if error %}
      <small id="input-hint">Select your company name from the browser suggestions for the correct spelling. 
      If this issue persists please contact a committee member.</small>
    {% endif %}

    <!-- name value sent to flask -->
    <input 
        type="search" 
        name="name" 
        id="company-input"
        list="company-names"
        class="search-input" 
        placeholder="Enter your company name" 
        autocomplete="off" 
        autocorrect="off" 
        autocapitalize="off" 
        spellcheck="false"
        required
    >

    <datalist id="company-names">
      {% for n in names %}
        <option value="{{ n }}"></option>
      {% endfor %}
    </datalist>

    <button class="animated-btn" type="submit">Search</button>
    <button class="animated-btn" type="button" onclick="window.location.href='/'">Back</button>
  </form>
</section>

<script>
/*
script to only show datalist suggestions after user types first letter
to avoid overwhelming with too many options at once.
*/

function isMobile() {
    return /Mobi|Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
}

if (isMobile()) {
    const input = document.getElementById('company-input');

    // remove datalist initially
    input.removeAttribute('list');

    input.addEventListener('input', () => {
        if (input.value.length >= 1) {
            input.setAttribute('list', 'company-names'); // attach after first letter
        } else {
            input.removeAttribute('list'); // hide again if input cleared
        }
    });
}
</script>
{% endblock %}
